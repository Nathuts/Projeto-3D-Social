"use strict";function pageLoaded(){$(".page-loader").fadeOut()}function pageLoading(){$(".page-loader").fadeIn()}function animateCharts(){$(".easy-pie-chart")[0]&&($(".easy-pie-chart canvas").remove(),$(".easy-pie-chart").each(function(){var a=($(this).data("value"),$(this).data("size")),b=$(this).data("track-color"),c=$(this).data("bar-color");$(this).find(".easy-pie-chart__value").css({lineHeight:a+"px",fontSize:a/4+"px",color:c}),$(this).easyPieChart({easing:"easeOutBounce",barColor:c,trackColor:b,scaleColor:"rgba(0,0,0,0)",lineCap:"round",lineWidth:2,size:a,animate:3e3,onStep:function(a,b,c){$(this.el).find(".percent").text(Math.round(c))}})}))}if(-1!=location.href.indexOf(".com"))var apiURL="https://rserver01.azurewebsites.net/api/";else var apiURL="http://127.0.0.1:5000/api/";var request={get:function(a){return axios.get(apiURL.concat(a)).then(function(a){return a}).catch(function(a){return a})},post:function(a,b){return axios.post(apiURL.concat(a),b).then(function(a){return a}).catch(function(a){return a})}},Center={get:function(){return request.get("Center").then(function(a){return a.data.forEach(function(a){a.address="".concat(a.street,", ").concat(a.addressNumber," - ").concat(a.district,", ").concat(a.city,", ").concat(a.zipCode)}),a.data}).catch(function(a){return a})},getById:function(a){return request.get("Center/".concat(a)).then(function(a){return a.data}).catch(function(a){return a})}},Demand={get:function(){return request.get("Demand").then(function(a){return a.data.forEach(function(a){a.percent=Math.round(100*a.totalDelivered/a.totalNeed)}),a.data}).catch(function(a){return a})},add:function(a){return request.post("Demand",a).then(function(a){return a.data}).catch(function(a){return a})},instance:function(){return{projectId:"",totalNeed:"",centerZipCode:"",centerStreet:"",centerDistrict:"",centerAddressNumber:"",centerCity:"",centerName:"",centerDocument:""}}},Project={get:function(){return request.get("Project").then(function(a){return a.data}).catch(function(a){return a})},getById:function(a){return request.get("Project/".concat(a)).then(function(a){return a.data}).catch(function(a){return a})},add:function(a){return request.post("Project",a).then(function(a){return a.data}).catch(function(a){return a})},instance:function(){return{name:"",description:"",file:""}}};$(document).ready(function(){function a(a,b){return a=$(a)[0].outerHTML,$.each(b,function(b,c){if("object"==typeof c)return void $.each(c,function(c,d){for(var e="{{"+b+"."+c+"}}";-1!=a.indexOf(e);)a=a.replace(e,d)});for(var d="{{"+b+"}}";-1!=a.indexOf(d);)a=a.replace(d,c)}),a}$("body").on("click",".navigation__sub > a",function(a){a.preventDefault(),$(this).parent().toggleClass("navigation__sub--toggled"),$(this).next("ul").slideToggle(250)}),$(".form-group--float")[0]&&($(".form-group--float").each(function(){0==!$(this).find(".form-control").val().length&&$(this).find(".form-control").addClass("form-control--active")}),$("body").on("blur",".form-group--float .form-control",function(){0==$(this).val().length?$(this).removeClass("form-control--active"):$(this).addClass("form-control--active")}),$(this).find(".form-control").change(function(){0==!$(this).val().length&&$(this).find(".form-control").addClass("form-control--active")})),$(".template-center")[0]&&function(){var b={},c={},d=[function(){Center.get().then(function(a){a.forEach(function(a,c){b[a.id]=a}),d.shift()()}).catch(function(a){console.log("Error while trying to get centers"),console.log(a)})},function(){Project.get().then(function(a){a.forEach(function(a,b){c[a.id]=a}),d.shift()()}).catch(function(a){console.log("Error while trying to get projects"),console.log(a)})},function(){Demand.get().then(function(e){var f=$(".template-center");e.forEach(function(d,e){d.center=b[d.centerID],d.project=c[d.projectID];var g=a(f,d);$(g).show(),$("#grid .column").eq(e%3).append(g)}),$(f).remove(),$("#grid .column > .card").fadeIn(300),animateCharts(),pageLoaded(),d.shift()()}).catch(function(a){console.log("Error while trying to get demands"),console.log(a),pageLoaded()})},function(){var a=[];$.each(c,function(b,c){a.push("<option value='"+b+"'>"+c.name+"</option>")}),$("[name=projectId]").append(a.join(""))}];d.shift()(),$("form").on("submit",function(a){a.preventDefault(),pageLoading();var b=Demand.instance();document.querySelectorAll("form [name]").forEach(function(a){b[a.name]=a.value.trim()}),b.projectId=parseInt(b.projectId),b.totalNeed=parseInt(b.totalNeed),Demand.add(b).then(function(a){pageLoaded(),200==a.status?alert("Solicitação adicionado com sucesso"):alert("Um erro ocorreu e a Solicitação não foi adicionado"),location.reload()}).catch(function(){pageLoaded(),alert("Um erro ocorreu e a Solicitação não foi adicionado"),location.reload()})})}(),$(".template-project")[0]&&function(){function b(a){return Project.add(a).then(function(a){return a}).catch(function(a){return a})}[function(){Project.get().then(function(b){var c=$(".template-project");b.forEach(function(b,d){var e=a(c,b);$(e).show(),$("#grid .column").eq(d%3).append(e)}),$(c).remove(),$("#grid .column > .card").fadeIn(300),pageLoaded()}).catch(function(a){console.log("Error while trying to get demands"),console.log(a),pageLoaded()})}].shift()(),$("#form-project").on("submit",function(a){a.preventDefault(),pageLoading();var c=Project.instance();c.name=$("[name=name]").val(),c.description=$("[name=description]").val(),c.file=$("[name=file]").val(),b(c).then(function(){pageLoaded(),alert("Projeto adicionado com sucesso"),location.reload()}).catch(function(){pageLoaded(),alert("Um erro ocorreu e o projeto não foi adicionado"),location.reload()})}),$("form button[type=submit]").attr("disabled",!0)}()}),$("#dropzone-upload")[0]&&(Dropzone.autoDiscover=!1),$(document).ready(function(){$(".textarea-autosize")[0]&&autosize($(".textarea-autosize")),$("input-mask")[0]&&$(".input-mask").mask(),$("#dropzone-upload")[0]&&$("#dropzone-upload").dropzone({url:"https://rserver01.azurewebsites.net/api/File/",paramName:"formFile",addRemoveLinks:!0,acceptedFiles:"application/zip, application/octet-stream",complete:function(a){console.log(a),"success"==a.status?($("[name=file]").val(a.xhr.responseText),$("form button[type=submit]").attr("disabled",!1)):alert("Houve um problema com o upload do arquivo")}}),$('[data-toggle="popover"]')[0]&&$('[data-toggle="popover"]').popover(),$('[data-toggle="tooltip"]')[0]&&$('[data-toggle="tooltip"]').tooltip(),$(".scrollbar-inner")[0]&&$(".scrollbar-inner").scrollbar().scrollLock()}),$(document).ready(function(){$("body").on("click","[data-ma-action]",function(a){a.preventDefault();var b=$(this),c=b.data("ma-action"),d="";switch(c){case"aside-open":d=b.data("ma-target"),b.addClass("toggled"),$(d).addClass("toggled"),$(".content, .header").append('<div class="ma-backdrop" data-ma-action="aside-close" data-ma-target='+d+" />");break;case"aside-close":d=b.data("ma-target"),$('[data-ma-action="aside-open"], '+d).removeClass("toggled"),$(".content, .header").find(".ma-backdrop").remove()}})});